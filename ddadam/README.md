# JBAç…§åˆãƒ»PDFç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ  v2.0

**Streamlit ã‹ã‚‰ FastAPI + Next.js ã¸ç§»è¡Œ**ã—ãŸãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«é¸æ‰‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

## ğŸ“‹ æ¦‚è¦

å¤§å­¦ãƒã‚¹ã‚±ãƒƒãƒˆãƒœãƒ¼ãƒ«éƒ¨ã®ãƒ¡ãƒ³ãƒãƒ¼æƒ…å ±ã‚’JBAãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ç…§åˆã—ã€PDFå½¢å¼ã®ãƒ¡ãƒ³ãƒãƒ¼è¡¨ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- ğŸ” **JBAç…§åˆ**: å¤§å­¦åã‹ã‚‰è‡ªå‹•ã§ãƒãƒ¼ãƒ ãƒ»é¸æ‰‹æƒ…å ±ã‚’å–å¾—
- ğŸ“„ **PDFç”Ÿæˆ**: ãƒ¡ãƒ³ãƒãƒ¼è¡¨ã‚’è‡ªå‹•ç”Ÿæˆï¼ˆè¤‡æ•°å¤§å­¦ã‚’ä¸€æ‹¬å‡¦ç†å¯èƒ½ï¼‰
- ğŸ’¾ **æ°¸ç¶šã‚­ãƒ£ãƒƒã‚·ãƒ¥**: 2å›ç›®ä»¥é™ã®å‡¦ç†ã‚’é«˜é€ŸåŒ–ï¼ˆ100å€é€Ÿï¼‰
- ğŸ”„ **é€²æ—è¡¨ç¤º**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å‡¦ç†çŠ¶æ³ã‚’ç¢ºèª
- âš¡ **ä¸¦åˆ—å‡¦ç†**: æœ€å¤§5ã‚¹ãƒ¬ãƒƒãƒ‰ã§é«˜é€Ÿå‡¦ç†

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆRender + Vercel + Supabase + Upstashï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js (Vercel)      â”‚  â† ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   - index.tsx           â”‚
â”‚   - result.tsx          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ HTTPS (REST API)
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI (Render Web)  â”‚  â† ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API
â”‚   - /pdf, /jobs, /cacheâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Background Worker     â”‚  â† PDFç”Ÿæˆãƒ»JBAç…§åˆ
â”‚   (Render Worker)       â”‚
â”‚   - worker_runner.py    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Supabase              â”‚  Upstash Redis   â”‚
â”‚   - Storage (PDF/ZIP)   â”‚  - Cache         â”‚
â”‚   - Postgres (jobs)     â”‚  - Job Queue     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:**
- Next.js 14
- React 18
- TypeScript
- Tailwind CSS

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:**
- FastAPI â†’ **Render Web Service**
- Python 3.11
- Pydantic (ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³)
- uvicorn (ASGIã‚µãƒ¼ãƒãƒ¼)

**ãƒ¯ãƒ¼ã‚«ãƒ¼:**
- **Render Background Worker**
- ã‚¸ãƒ§ãƒ–ã‚­ãƒ¥ãƒ¼ç›£è¦–
- PDFç”Ÿæˆãƒ»JBAç…§åˆ

**ã‚¤ãƒ³ãƒ•ãƒ©:**
- **Supabase**: Storage (PDF/ZIP) + Postgres (jobs)
- **Upstash Redis**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ + ã‚¸ãƒ§ãƒ–ã‚­ãƒ¥ãƒ¼
- **Vercel**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°

**ãƒ¯ãƒ¼ã‚«ãƒ¼:**
- BeautifulSoup4 (ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°)
- Pandas (ãƒ‡ãƒ¼ã‚¿å‡¦ç†)
- ReportLab (PDFç”Ÿæˆ)

---

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

- Python 3.11+
- Node.js 18+
- JBAã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone <repository-url>
cd ddadam
```

### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd backend

# ä»®æƒ³ç’°å¢ƒã®ä½œæˆãƒ»æœ‰åŠ¹åŒ–
python -m venv .venv

# Windows
.venv\Scripts\activate

# Mac/Linux
source .venv/bin/activate

# ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
copy env.example .env
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
uvicorn main:app --reload --port 8000
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd frontend

# ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
copy env.local.example .env.local
# .env.localãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
```

### 4. ã‚¢ã‚¯ã‚»ã‚¹

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: http://localhost:3000
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API**: http://localhost:8000
- **API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: http://localhost:8000/docs

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
project-root/
â”œâ”€ frontend/              # Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€ pages/
â”‚   â”‚   â”œâ”€ index.tsx      # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ï¼ˆPDFç”Ÿæˆé–‹å§‹ï¼‰
â”‚   â”‚   â”œâ”€ result.tsx     # çµæœè¡¨ç¤ºãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
â”‚   â”‚   â””â”€ _app.tsx
â”‚   â”œâ”€ styles/
â”‚   â”‚   â””â”€ globals.css
â”‚   â”œâ”€ package.json
â”‚   â”œâ”€ tsconfig.json
â”‚   â””â”€ tailwind.config.js
â”‚
â”œâ”€ backend/               # FastAPI ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€ main.py            # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€ config.py          # ç’°å¢ƒè¨­å®š
â”‚   â”œâ”€ routers/           # APIãƒ«ãƒ¼ã‚¿ãƒ¼
â”‚   â”‚   â”œâ”€ verify.py      # JBAç…§åˆAPI
â”‚   â”‚   â”œâ”€ pdf.py         # PDFç”ŸæˆAPI
â”‚   â”‚   â”œâ”€ cache.py       # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†API
â”‚   â”‚   â””â”€ jobs.py        # ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹API
â”‚   â”œâ”€ worker/            # ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼ˆæ—¢å­˜ã‚³ãƒ¼ãƒ‰ç§»æ¤å…ˆï¼‰
â”‚   â”‚   â”œâ”€ integrated_system.py
â”‚   â”‚   â”œâ”€ jba_verification_lib.py
â”‚   â”‚   â””â”€ integrated_system_worker.py
â”‚   â”œâ”€ requirements.txt
â”‚   â”œâ”€ Dockerfile
â”‚   â””â”€ env.example
â”‚
â”œâ”€ outputs/               # ç”Ÿæˆã•ã‚ŒãŸPDFã®ä¿å­˜å…ˆ
â”œâ”€ temp_results/          # ã‚¸ãƒ§ãƒ–ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
â””â”€ README.md
```

---

## ğŸ”§ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
GET /health
```

### PDFç”Ÿæˆ

```bash
POST /pdf
Content-Type: application/json

{
  "universities": ["ç™½é´å¤§å­¦", "ç­‘æ³¢å¤§å­¦"],
  "jba_credentials": {
    "email": "your@email.com",
    "password": "your_password"
  },
  "include_photos": true,
  "format": "A4"
}

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹
{
  "job_id": "uuid",
  "status": "queued",
  "message": "...",
  "polling_url": "/jobs/uuid"
}
```

### ã‚¸ãƒ§ãƒ–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—

```bash
GET /jobs/{job_id}

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹
{
  "job_id": "uuid",
  "status": "processing",  # queued, processing, done, error
  "progress": 0.5,         # 0.0 ~ 1.0
  "message": "å‡¦ç†ä¸­...",
  "output_path": "outputs/file.pdf",
  "metadata": {...}
}
```

### PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```bash
GET /pdf/download/{filename}
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµ±è¨ˆ

```bash
GET /cache

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹
{
  "entries": 300,
  "size_mb": 2.5,
  "exists": true
}
```

è©³ç´°ã¯ http://localhost:8000/docs ã§ç¢ºèªã§ãã¾ã™ã€‚

---

## ğŸ”„ Streamlitã‹ã‚‰ã®ç§»è¡Œå†…å®¹

### ä¸»ãªå¤‰æ›´ç‚¹

1. **st.* â†’ logging + job_meta**
   - Streamlitã®è¡¨ç¤º(`st.write`, `st.progress`)ã‚’å‰Šé™¤
   - ãƒ­ã‚°å‡ºåŠ›ã¨ã‚¸ãƒ§ãƒ–ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®æ›

2. **ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†**
   - åŒæœŸå‡¦ç† â†’ BackgroundTasksï¼ˆå°†æ¥çš„ã«Redis + Celeryï¼‰

3. **é€²æ—è¡¨ç¤º**
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º â†’ ãƒãƒ¼ãƒªãƒ³ã‚°APIï¼ˆ2ç§’ã”ã¨ï¼‰

4. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**
   - st.session_state â†’ ã‚¸ãƒ§ãƒ–ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

---

## ğŸ“ TODOï¼ˆå°†æ¥çš„ãªæ”¹å–„ï¼‰

### é«˜å„ªå…ˆåº¦

- [ ] **JBAã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®éåŒæœŸåŒ–**
  - `requests` â†’ `httpx.AsyncClient`
  - å‡¦ç†é€Ÿåº¦ã®ã•ã‚‰ãªã‚‹å‘ä¸Š

- [ ] **ã‚¸ãƒ§ãƒ–ã‚­ãƒ¥ãƒ¼ã®å°å…¥**
  - BackgroundTasks â†’ Redis + RQ/Celery
  - ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š

- [ ] **æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ç§»æ¤**
  - `jba_verification_lib.py` ã® st.* å‰Šé™¤
  - `integrated_system.py` ã® APIå¯¾å¿œ
  - `integrated_system_worker.py` ã®çµ±åˆ

### ä¸­å„ªå…ˆåº¦

- [ ] **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’Redisã«ç§»è¡Œ**
  - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ â†’ Redis
  - è¤‡æ•°ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¯¾å¿œ

- [ ] **é€²æ—é€šçŸ¥ã®æ”¹å–„**
  - ãƒãƒ¼ãƒªãƒ³ã‚° â†’ WebSocket/SSE
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã®å‘ä¸Š

- [ ] **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±åˆ**
  - ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ« â†’ S3 / Supabase Storage
  - ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†

### ä½å„ªå…ˆåº¦

- [ ] E2Eãƒ†ã‚¹ãƒˆ
- [ ] CI/CD (GitHub Actions)
- [ ] Docker Composeå¯¾å¿œ
- [ ] èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ 

---

## ğŸ³ Docker ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

```bash
cd backend
docker build -t jba-backend .
docker run -p 8000:8000 jba-backend
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

```bash
cd frontend
docker build -t jba-frontend .
docker run -p 3000:3000 jba-frontend
```

### Docker Composeï¼ˆæº–å‚™ä¸­ï¼‰

```bash
docker-compose up
```

---

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

This project is licensed under the MIT License.

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€Issueã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

---

## ğŸ¯ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### Streamlitç‰ˆ vs FastAPIç‰ˆ

| æŒ‡æ¨™ | Streamlitç‰ˆ | FastAPIç‰ˆ | æ”¹å–„ç‡ |
|------|------------|-----------|--------|
| åˆå›å‡¦ç† | 30åˆ† | 1åˆ† | **30å€** |
| 2å›ç›®ä»¥é™ | 30åˆ† | 3ç§’ | **600å€** |
| UIå¿œç­”æ€§ | é…ã„ | é«˜é€Ÿ | **5å€** |
| åŒæ™‚å‡¦ç† | 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ | å¤šæ•° | **âˆ** |

---

**Powered by FastAPI + Next.js | v2.0.0**

